{% extends "base.html" %}
{% load static %}

{% block head_extra %}
<link rel="stylesheet" href="{% static 'css/growthlog.css' %}">
{% endblock %}

{% block content %}

<div class="growthlog-subtitle">園での生活・成長記録</div>

<div class="growthlog-body">
  <form method="post" action="{% url 'schoollogs:select_child' %}">
    {% csrf_token %}
    <select class="child-select" name="child_id" onchange="this.form.submit()">
      <option value="">園児を選択</option>
      {% for child in children %}
        <option value="{{ child.id }}"
          {% if selected_child and child.id == selected_child.id %}selected{% endif %}>
          {{ child }}
        </option>
      {% endfor %}
    </select>
    <input type="hidden" name="next" value="{{ request.get_full_path }}">
  </form>

  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}  

    <div class="growthlog-field shift-wide">
      <div class="growthlog-label">昼　食</div>
      <div class="growthlog-input-inline button-choices">
        {% for radio in form.school_lunch %}
          <label class="choice-btn">
            {{ radio.tag }}
            <span>{{ radio.choice_label }}</span>
          </label>        
        {% endfor %}
      </div>
    </div>

    <div class="growthlog-field growthlog-nap">
      <div class="growthlog-label">午睡時間</div>
      <div class="growthlog-input-inline">
        {{ form.school_nap_start.errors }}
        {{  form.school_nap_start }}
        <span class="nap-sep"> ～ </span>
        {{ form.school_nap_end.errors }}
        {{ form.school_nap_end }}
      </div>
    </div>

    <div class="growthlog-field shift-wide">
      <div class="growthlog-label">排　便</div>
      <div class="growthlog-input-inline button-choices">
        {% for radio in form.school_poo %}
          <label class="choice-btn">
            {{ radio.tag }}
            <span>{{ radio.choice_label }}</span>
          </label>        
        {% endfor %}
      </div>
    </div>

    <div class="growthlog-field shift-narrow">
      <div class="growthlog-label">体　調</div>
      <div class="growthlog-input-inline">
        {{ form.school_condition.errors }}
        {{ form.school_condition }}
      </div>
    </div>

    <div class="growthlog-field shift-narrow growthlog-temp">
      <div class="growthlog-label">体　温</div>
      <div class="growthlog-input-inline">
        {{ form.school_temperature.errors }}
        {{ form.school_temperature }} <span class="unit">℃</span>
      </div>
    </div>

    <div class="growthlog-field shift-narrow growthlog-textarea">
      <div class="growthlog-label">様　子</div>
      <div class="growthlog-input-inline">
        {{ form.school_state.errors }}
        {{ form.school_state }}
      </div>
    </div>

    <div class="growthlog-actions">
      <button type="submit" name="action" value="draft" class="growthlog-btn">
        一時保存
      </button>
      <button type="button" class="growthlog-btn growthlog-btn-primary"
              onclick="return openConfirmBox();">
        提　出
      </button>
    </div>

    <div class="growthlog-confirm-box" id="confirm-box" style="display: none;">
      <div>
        提出後は修正できません。<br>
        提出してもよろしいですか？
      </div>
      <div class="growthlog-confirm-actions">
        <button type="submit" name="action" value="submit"
                class="growthlog-btn growthlog-btn-primary">は　い</button>
        <button type="button" class="growthlog-btn"
                onclick="closeConfirmBox();">いいえ</button>
      </div>
    </div>
  </form>
</div>

<script>
  function openConfirmBox() {
    document.getElementById("confirm-box").style.display = "block";
    return false; // すぐ送信させない
  }
  function closeConfirmBox() {
    document.getElementById("confirm-box").style.display = "none";
  }
</script>

{% endblock %}
